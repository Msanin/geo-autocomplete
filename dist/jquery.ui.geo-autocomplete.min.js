/*!
 jquery.ui.geo-autocomplete - v2.1.2 - 2013-09-01
 git://github.com/vogdb/geo-autocomplete.git
 Copyright (c) 2013 Bob Hitching and other contributors https://github.com/vogdb/geo-autocomplete/blob/2.1.2/AUTHORS.txt;
 Licensed MIT, GPL

 Requires jQuery UI Autocomplete 
*/
$.widget("ui.geo_autocomplete",{_create:function(){this.options._geocoder=new google.maps.Geocoder,this.options._cache={},this.element.autocomplete(this.options),this.element.data("uiAutocomplete")._renderItem=function(a,b){return $("<li></li>").data("item.autocomplete",b).append(this.options.getItemHTML(b)).appendTo(a)}},options:{geocoder_region:"",geocoder_types:"locality,political,sublocality,neighborhood,country",geocoder_address:!1,mapwidth:100,mapheight:100,maptype:"terrain",mapsensor:!1,minLength:3,delay:300,source:function(a,b){if(a.term in this.options._cache)b(this.options._cache[a.term]);else{var c=this,d=a.term+(this.options.geocoder_region?", "+this.options.geocoder_region:"");this.options._geocoder.geocode({address:d},function(d,e){var f=[];if(d&&e&&"OK"==e){var g=c.options.geocoder_types.split(",");$.each(d,function(b,d){if($.map(d.types,function(a){return-1!=$.inArray(a,g)?a:null}).length&&d.geometry&&d.geometry.viewport){if(c.options.geocoder_address)h=d.formatted_address;else{var e=d.formatted_address.split(","),h=e[0];$.each(e,function(b,c){return-1!=c.toLowerCase().indexOf(a.term.toLowerCase())?(h=$.trim(c),!1):void 0})}f.push({value:h,label:d.formatted_address,viewport:d.geometry.viewport})}})}c.options._cache[a.term]=f,b(f)})}},getItemHTML:function(a){var b="http://maps.google.com/maps/api/staticmap?visible="+a.viewport.getSouthWest().toUrlValue()+"|"+a.viewport.getNorthEast().toUrlValue()+"&size="+this.mapwidth+"x"+this.mapheight+"&maptype="+this.maptype+"&sensor="+(this.mapsensor?"true":"false");return'<a><img style="float:left;margin-right:5px;" src="'+b+'" width="'+this.mapwidth+'" height="'+this.mapheight+'" /> '+a.label.replace(/,/gi,",<br/>")+'<br clear="both" /></a>'}}});